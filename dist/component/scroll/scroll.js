define("component/scroll/scroll",["gallery/iscroll/iscroll-probe.js"],function(a,b){b.init=function(b){var c,d,e,f,g,h,i,j,k,l=a("gallery/iscroll/iscroll-probe.js");if(d={page:null,selector:"",refreshUrl:"",enableRefresh:!0,enableLoadmore:!0},e=$.extend(!0,{},d,b),g=$(e.selector),h=g.find(".j-loadmore"),i=g.find(".j-pullDown"),j=g.find(".j-pullDown-helper"),k=parseInt(g.find(".j-hasData").val()),c=new l(e.selector,{click:!0,tap:!0,mouseWheel:!0,scrollbars:!0,probeType:2}),e.enableRefresh||e.enableLoadmore){var f=0;return e.enableRefresh&&c.on("scroll",function(){this.y<50&&j.height(this.y),f=this.y,this.y>50&&!i.hasClass("flip")?(i.addClass("flip"),i.text("释放立即刷新...")):this.y<50&&i.hasClass("flip")&&(i.removeClass("flip"),i.text("下拉刷新..."))}),c.on("scrollEnd",function(){e.enableLoadmore&&k&&this.y-50<=this.maxScrollY&&0!=this.y&&(h.css("opacity",1),setTimeout(function(){var a="<li>新增内容</li><li>新增内容</li><li>新增内容</li><li>新增内容</li><li>新增内容</li>";g.find(".comm-list").empty().append(a),c.refresh(),h.css("opacity",0)},1e3)),50>f&&j.animate({height:0},100),e.enableRefresh&&i.hasClass("flip")&&(i.addClass("pulldown-loading"),i.text("正在刷新..."),g.find(".j-refreshPanel").load(e.refreshUrl+"?v="+_.random(1,1e3)+" .comm-list",function(a,b){var d="";d="success"==b?"刷新成功":"刷新失败，请重试",i.text(d),setTimeout(function(){j.animate({height:0},100),i.removeClass("pulldown-loading"),c.refresh()},600)}))}),c}}});